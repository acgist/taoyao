# 信令

## 信令

```
{
	"header": {
		"v": "版本",
		"id": 请求标识,
		"sn": "设备标识"
		"pid": 信令标识,
	},
	"code": "响应编码",
	"message": "响应描述",
	"body": {
		// 信令主体
	}
}
```

## 平台信令（1000~1999）

### 关闭服务信令（1000）

终端->服务端：关闭信令服务

```
{}
```

### 执行命令信令（1001）

终端->服务端：执行系统命令

```
{
	"script": "命令"
}
```

### 异常信令（1999）

服务端->终端：提示异常信息

```
{}
```

## 终端信令（2000~2999）

### 注册信令（2000）

终端->服务端：注册成功后服务端响应，同时下发配置信息，广播终端上线事件。

```
{
	"username": "信令授权用户",
	"password": "信令授权密码",
	"ip": "IP地址",
	"mac": "MAC地址",
	"signal": "信号强度",
	"battery": "电池电量"
}
```

### 关闭信令（2001）

终端->服务端：广播终端下线事件，同时释放所有资源（信令通道、媒体通道等等）

```
{}
```

### 上线信令（2002）

服务端->终端：参考[注册信令](#注册信令)

```
{
	"sn": "终端标识"
}
```

### 下线信令（2003）

服务端->终端：参考[关闭信令](#关闭信令)

```
{
	"sn": "终端标识"
}
```

### 下发配置信令（2004）

服务端->终端：参考[注册信令](#注册信令)

```
{
	"time": "系统时间：yyyyMMddHHmmss",
	"media": "媒体配置",
	"webrtc": "WebRTC配置"
}
```

### 心跳信令（2005）

心跳：响应

```
{
	"signal": "信号强度",
	"battery": "电池电量"
}
```

### 终端列表信令（2006）

返回所有终端状态列表

```
{}
```

### 终端状态信令（2007）

返回指定终端状态（如果没有指定终端标识默认查询自己）

```
{
	"sn": "终端标识"
}
```

### 单播信令（2008）

发送到指定的终端：删除`to`字段

```
{
	"to": "接收终端标识",
	// 主体信息
}
```

### 广播信令（2009）

发送到所有的终端：排除自己

```
{
	// 主体信息
}
```

## 直播信令（3000~3999）

```
创建会议 -> 邀请终端|踢出终端|加入会议|离开会议 -> 光比会议
```

### 开启直播信令（3000）

### 关闭直播信令（3001）

### 直播终端列表信令（3002）

## 会议信令（4000~4999）

### 创建会议信令（4000）

### 关闭会议信令（4001）

释放资源、广播广播

### 进入会议信令（4002）

广播

### 离开会议信令（4003）

广播

### 邀请终端信令（4004）

邀请终端进入会议，终端确认进入发送进入会议信令。

### 踢出终端信令（4005）

广播

### 会议终端列表信令（4006）

## 媒体信令（5000~5999）

### 发布信令（5000）

控制终端推流（服务端拉流）

### 取消发布指令（5001）

控制终端暂停推流（服务端取消拉流）

### 订阅指令（5002）

订阅终端媒体流（终端拉流）

### 取消订阅指令（5003）

取消订阅终端媒体流（终端取消拉流）

### 暂停指令（5004）

暂停发布、订阅（不关媒体流通道）

### 恢复指令（5005）

暂停发布、订阅（不关媒体流通道）

### 开启录像（5006）

### 停止录像（5007）
